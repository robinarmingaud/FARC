{% extends "layout.html.j2" %}

{% set DEBUG=False %}
{% set active_page="calculator/" %}

{% block extra_headers %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" integrity="sha512-aOG0c6nPNzGk+5zjwyJaoRUgCdOrfSDhmMID2u4+OIslr0GjpLKo7Xm0Ao3xmpM4T8AmIouRkqwj1nrdVsLKEQ==" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/form.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"/>
{% endblock extra_headers %}

{% block body_scripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA==" crossorigin="anonymous"></script>
    <script src="/static/js/form.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
{% endblock body_scripts %}


{% block main %}

<span class="cara_version">v{{ calculator_version }}</span>
<span class="ml-2 feedback">{{_("Please send feedback to ")}}<a href="mailto:Flow-R-dev@ingenica.fr">Flow-R-dev@ingenica.fr</a></span>
<header class= "bg-light">
  <div class="container container--padding">
    <div class="d-flex header-height">
      <h1 class="align-self-center">{{_("FARC Calculator")}}</h1>
      <img src="/static/images/Logo_Flow-R_Couleur@2x.png" class="logo_form align-self-center ml-3">
    </div>
  </div>
</header>

{% if DEBUG %}
<form id="covid_calculator" name="covid_calculator" onsubmit="return debug_submit(this)" class="form-inline">
{% else %}
<form id="covid_calculator" name="covid_calculator" action="{{ calculator_prefix }}/report" onsubmit="return validate_form(this)" method="POST">
{% endif %}
{{ xsrf_form_html }}

<input type="hidden" name="calculator_version" value="{{ calculator_version }}">

<section>
  <div class="container container--padding">
  <div class="split">
  <div>
    <!-- General Options -->

    <div class="form-group">
      <b><label class="col-form-label">{{_("Simulation name:")}}</label></b>
      <input type="text" class="col-sm-10 form-control" name="simulation_name" placeholder="{{default.simulation_name}}">
    </div>

    <div class="form-group">
      <b><label class="col-form-label">{{_("Room number:")}}</label></b>
      <input type="text" class="col-sm-10 form-control" name="room_number" placeholder="{{default.room_number}}">
    </div>

    <hr width="80%">

    <b>{{_("Virus data:")}}</b>

    <div data-tooltip="{{TOOLTIPS.virus_data}}">
        <span class="tooltip_text">?</span>
    </div><br>

    <div class="form-group row">
    <div class="col-sm-3"><label class="col-form-label">{{_("Variant:")}} </label></div>
    <div class="col-sm-7">
    <select id="Variant" name="virus_type" class="form-control">
      {% for key in default.viruses.keys()%}
        {% if key != default.virus_type %}
          <option value={{key}}>{{default.viruses[key]}}</option>
        {% endif %}
      {% endfor %}
      <option selected value="{{default.virus_type}}">{{default.viruses[default.virus_type]}}</option>
    </select>
    </div>
    </div>

    <hr width="80%">

    <b>{{_("Room data:")}}</b>
    {% block room_data %}
    <div data-tooltip="{{TOOLTIPS.room_data}}">
        <span class="tooltip_text">?</span>
    </div>
    {% endblock room_data %}
    
    <br>

    <div class="form-group row">
      <div class="col-sm-4">
        <input type="radio" class= "room_volume" id="room_data_volume" name="volume_type" value='room_volume_explicit' onclick="require_fields(this)" tabindex="-1" required>
        <label for="room_data_volume" class="col-form-label">{{_("Room volume:")}}</label>
      </div>
      <div class="col-sm-6">
        <input type="number" step="any" id="room_volume" class="non_zero form-control" name="room_volume" placeholder="{{PLACEHOLDERS.room_volume}}" min="0" data-has-radio="#room_data_volume" value="{{default.room_volume}}">
      </div>
    </div>
    

    <div class="form-group row">
      <div class="col-sm-4">
        <input type="radio" class = "room_volume" id="room_data_dimensions" name="volume_type" value='room_volume_from_dimensions' onclick="require_fields(this)" tabindex="-1" required>
        <label for="room_data_dimensions">{{_("Floor area:")}}</label>
      </div>
      <div class="col-sm-6">
        <input type="number" step="any" id="floor_area" class="non_zero form-control" name="floor_area" placeholder="{{PLACEHOLDERS.room_floor_area}}" min="0" data-has-radio="#room_data_dimensions" value ="{{default.floor_area}}">
      </div>  
    </div>
    <div class="form-group row">
      <div class="col-sm-4">
        <label for="room_data_dimensions">{{_("Ceiling height:")}} </label>
      </div>
      <div class="col-sm-6">
        <input type="number" step="any" id="ceiling_height" class="non_zero form-control" name="ceiling_height" placeholder="{{PLACEHOLDERS.ceiling_height}}" min="0" data-has-radio="#room_data_dimensions" value ="{{default.ceiling_height}}">
      </div>
    </div>

    <div class="split">
    <div>{{_("Central heating system in use:")}}</div>
    <div>
    <input class="ml-2 heating_option" type="radio" id="heating_no" name="room_heating_option" value='0'>
      <label for="heating_no">{{_("No")}}</label>
    <input class="ml-2 heating_option" type="radio" id="heating_yes" name="room_heating_option" value='1'>
      <label for="heating_yes">{{_("Yes")}}</label>
    </div>
    </div>
    <div class="form-group row">
      <div class="col-sm-5"><label class="col-form-label">{{_("Geographic location:")}}</label></div>
      <div class="col-sm-5 align-self-center"><select id="location_select" form="not-submitted" class="form-control" name="location_select" required></select></div>
    </div>
    <div id="location_div">
        <!--
        This block allows us to have hidden input values which are retained during forward/back navigation, as per
        https://stackoverflow.com/a/6384276/741316
        -->
        <input type="text" name="location_name" value="{{default.location_name}}">
        <input type="text" name="location_latitude" value={{default.location_latitude}}>
        <input type="text" name="location_longitude" value={{default.location_longitude}}>
    </div>

    <hr width="80%">

    <!-- Ventilation Options -->
    <b>{{_("Ventilation data:")}}</b>
    <div data-tooltip="{{TOOLTIPS.ventilation_data}}">
        <span class="tooltip_text">?</span>
    </div>
    
    <br>

    <div class='sub_title'>{{_("Ventilation type:")}}</div>
    
    <div class="split">
    <div>
    <input type="radio" class="ml-2 ventilation_option" id="no_ventilation" name="ventilation_type" value='no_ventilation' >
      <label for="no_ventilation">{{_("No ventilation")}}</label>
    <input class="ml-2 ventilation_option" type="radio" id="mechanical_ventilation" name="ventilation_type" value='mechanical_ventilation' data-enables="#DIVmechanical_ventilation">
      <label for="mechanical_ventilation">{{_("Mechanical")}}</label>
    <input type="radio" class="ml-2 ventilation_option" id="natural_ventilation" name="ventilation_type" value='natural_ventilation' data-enables="#DIVnatural_ventilation" data-toggle="modal" data-target="#warning_modal">
      <label for="natural_ventilation">{{_("Natural")}}</label><br>
    </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="warning_modal" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">{{_("Natural Ventilation")}}</h4>
            <button type="button" class="close align-self-center" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
          {{_("Single-sided ventilation is assumed in the model and is typically effective for room depths up to a depth 2.5 x the ceiling height. 
            If these conditions are not met, the air exchange might not be homogenous producing an artificially lower risk further away from the window.")}}
            <br>
            <br>
            <img src="/static/images/nat_vent_dimensions.png" id="nat_vent_image">
          </div>
        </div>
      </div>
    </div>

    <div id="DIVmechanical_ventilation" class="tabbed">
        <div class="split">
          <div>
          <input type="radio"  id="mech_type_air_supply" name="mechanical_ventilation_type" value="mech_type_air_supply" class="center_radio mech_type_option" onclick="require_fields(this)" tabindex="-1">
          <label for="mech_type_air_supply" class="col-form-label ml-2">{{_("Air supply flow rate")}}</label>
          </div>
          <div>
          <input type="number" step="any" id="air_supply" class="non_zero form-control" name="air_supply" min="0" placeholder="{{PLACEHOLDERS.flow_rate}}" data-has-radio="#mech_type_air_supply" value="{{default.air_supply}}"><br>
          </div>
        </div>
        <div class="split">
          <div>
          <input type="radio" id="mech_type_air_changes" name="mechanical_ventilation_type" value="mech_type_air_changes" class="center_radio mech_type_option" onclick="require_fields(this)" tabindex="-1">
          <label for="mech_type_air_changes" class="col-form-label ml-2">{{_("Air changes per hour")}}</label>
          </div>
          <div>
          <input type="number" step="any" id="air_changes" class="non_zero form-control" name="air_changes" min="0" placeholder="{{PLACEHOLDERS.air_exchange}}" data-has-radio="#mech_type_air_changes" value="{{default.air_changes}}"><br>
          </div>
        </div>
    </div>

    <div id="DIVnatural_ventilation" class="tabbed">
      <div class="split">
        <div><label class="col-form-label">{{_("Number of windows:")}} </label></div>
        <div><input type="number" id="windows_number" class="non_zero form-control" name="windows_number" placeholder="{{PLACEHOLDERS.number}}" min="1" value = "{{default.windows_number}}"><br></div>
      </div>
      <div class="split">
        <div><label class="col-form-label">{{_("Height of window:")}}</label></div>
        <div><input type="number" step="any" id="window_height" class="non_zero form-control" name="window_height" placeholder="{{PLACEHOLDERS.height}}" min="0" value = '{{default.window_height}}'><br></div>
      </div>
        <div class='sub_title'>{{_("Window type:")}} </div>
        <input class="ml-2 window_type_option" type="radio" id="window_sliding" name="window_type" value="window_sliding" onclick="require_fields(this)">
          <label for="window_sliding">{{_("Sliding / Side-Hung")}}</label>
        <input class="ml-2 window_type_option" type="radio" id="window_hinged" name="window_type" value="window_hinged" onclick="require_fields(this)">
          <label for="window_hinged">{{_("Top- or Bottom-Hung")}}</label><br>
        <div class="split">
          <div><label class="col-form-label">{{_("Width of window:")}}</label></div>
          <div><input type="number" step="any" id="window_width" class="non_zero disabled form-control" name="window_width" placeholder="{{PLACEHOLDERS.width}}" min="0" data-has-radio="#window_hinged" value = "{{default.window_width}}"><br></div>
        </div>
        <div class="split">
          <div><label class="col-form-label">{{_("Opening distance:")}} </label></div>
          <div><input type="number" step="any" id="opening_distance" class="non_zero form-control" name="opening_distance" placeholder="{{PLACEHOLDERS.opening_distance}}" min="0" value = '{{default.opening_distance}}'><br></div>
        </div>
        <div class='sub_title'>{{_("Window open")}}:
        <div data-tooltip="{{TOOLTIPS.window_open}}">
          <span class="tooltip_text">?</span>
        </div>
        </div>
        <div class="form-group row">
          <span class="tabbed center_radio"><input type="radio" class="window_open_option" id="windows_open_permanently" name="window_opening_regime" value="windows_open_permanently" onclick="require_fields(this)"></span>
          <label for="windows_open_permanently" class="col-form-label ml-2">{{_("Permanently")}} </label><br>
        </div>
        <div class="form-group row">
          <span class="tabbed center_radio"><input type="radio" class="window_open_option" id="windows_open_periodically" name="window_opening_regime" value="windows_open_periodically" onclick="require_fields(this)"></span>
          <label for="windows_open_periodically" class="col-form-label ml-2 mr-2">{{_("Periodically:")}} </label><br>
          <input type="number" step="any" id="windows_duration" class="ml-2 non_zero disabled form-control col-sm-4" name="windows_duration" placeholder="{{PLACEHOLDERS.duration}}" min="1" data-has-radio="#windows_open_periodically" value = '{{default.windows_duration}}'> 
          <input type="number" step="any" id="windows_frequency" class="ml-2 non_zero disabled form-control col-sm-4" name="windows_frequency" placeholder="{{PLACEHOLDERS.frequency}}" min="1" data-has-radio="#windows_open_periodically" value = '{{default.windows_frequency}}'>
        </div>
        <br>
    </div>

    <div class='sub_title'>{{_("Bio ventilation:")}}
    <div data-tooltip="{{TOOLTIPS.bio_ventilation}}">
        <span class="tooltip_text">?</span>
    </div>
    </div>
    <div class="split">
    <div>
    <input type="radio" class="biov_option" id="biov_no" name="biov_option" value = 0>
      <label for="biov_no" class="col-form-label ml-2">{{_("No")}} </label>
    <input class="ml-2 biov_option" type="radio" id="biov_yes" name="biov_option" value = 1>
      <label for="biov_yes" class="col-form-label ml-2">{{_("Yes")}}</label>
    </div>
    <div>
    <input type="number" id="biov_amount" class="non_zero form-control" name="biov_amount" placeholder="{{PLACEHOLDERS.flow_rate}}" min="0" value="{{default.biov_amount}}" step="100" >
    </div>
    </div>
    <hr width="80%">

    <b>{{_("Face masks:")}} </b>
    <div data-tooltip="{{TOOLTIPS.face_mask}}">
        <span class="tooltip_text">?</span>
    </div>
    
    <br>
    
    <div class='sub_title'>{{_("Are masks worn when occupants are at workstations?")}} </div>
    <input type="radio" class ="mask_wearing_option" id="mask_on" name="mask_wearing_option" value="mask_on" onclick="enableMaskSelection()">
      <label for="mask_on">{{_("Yes")}} </label>
    <input class="ml-2 mask_wearing_option" type="radio" id="mask_off"  name="mask_wearing_option" value="mask_off" onclick="enableMaskSelection()">
      <label for="mask_off">{{_("No")}} </label><br>
      
    <div id="DIVmasks_used">
      <div class='sub_title'>{{_("Type of masks used (necessary for alternative scenarios):")}} </div>
      <div class='split'>
        <div>
          <input type="radio" class="mask_type_option" id="mask_type_1" name="mask_type" value="Type_I" onclick="require_fields(this)">
            <label for="mask_type_1">
             {{_("Surgical/Type I")}}
              <img class="mask_icons" src="/static/images/masks/t1.png">
            </label>
        </div>
        <div>
          <input type="radio" class="mask_type_option"  id="mask_type_ffp2"  name="mask_type" value="FFP2" onclick="require_fields(this)">
            <label for="mask_type_ffp2">
             {{_("Respirator/FFP2")}}
              <img class="mask_icons" src="/static/images/masks/ffp2.png">
            </label>
        </div>
      </div>
    </div>
    <hr width="80%">

  </div>
  <div>

    <!-- Event Options -->
    <b>{{_("Event data:")}} </b>
    <div data-tooltip="{{TOOLTIPS.event_data}}">
        <span class="tooltip_text">?</span>
    </div><br>

    <div class="form-group row">
      <div class="col-sm-4"><label class="col-form-label">{{_("Total number of occupants:")}} </label></div>
      <div class="col-sm-6 align-self-center"><input type="number" id="total_people" class="form-control" name="total_people" placeholder="{{PLACEHOLDERS.number}}" min=1 value='{{default.total_people}}' required></div>
    </div>

    <div class="form-group row">
      <div class="col-sm-4"><label class="col-form-label">{{_("Number of infected people:")}}</label></div>
      <div class="col-sm-6 align-self-center"><input type="number" id="infected_people" class="form-control" name="infected_people" placeholder="{{PLACEHOLDERS.number}}" min=1 value='{{default.infected_people}}' required></div>
    </div>

    <span id="training_limit_error" class="red_text" hidden>{{_("Conference/Training activities limited to 1 infected")}} <br></span>
    <hr width="80%">

    <!-- removed by OPE when introduced different activity types for infected and exposed
    <div class="form-group row">
    <div class="col-sm-4"><label class="col-form-label">Activity type:</label></div>
    <div class="col-sm-6">
      <select id="activity_type" name="activity_type" class="form-control">

        <option value="office">Office</option>
        <option value="smallmeeting">Small meeting (<10 occ.)</option>
        <option value="largemeeting">Large meeting (>=10 occ.)</option>
        <option value="callcentre">Call Centre</option>
        <option value="controlroom-day">Control Room - Day shift</option>
        <option value="controlroom-night">Control Room - Night shift</option>
        <option value="library">Library</option>
        <option value="lab">Laboratory</option>
        <option value="workshop">Workshop</option>
        <option value="training">Conference/Training</option>
        <option value="gym">Gym</option>
        <option value="watch_seated">Watch seated</option>
        <option value="watch_standing">Watch standing</option>      </select>
    </div>
    </div>
    -->

    <div class="peopleBox">
      <div class="boxMargin pb-0">
        <div class='sub_title'>{{_("Exposed person(s):")}} </div>
        <div class="form-group row">
            <div class="col-sm-4"><label class="col-form-label">{{_("Activity type:")}} </label></div>
            <div class="col-sm-6">
                <select id="exposed_activity_type" name="exposed_activity_type" class="form-control">
                  {% set default_exposed_activity = ACTIVITY_TYPES | selectattr('Id', 'equalto', default.exposed_activity_type) | first %}
                    <optgroup label="---- {{PLACEHOLDERS.default}} ----">
                      <option selected value="{{default_exposed_activity.Id}}">{{default_exposed_activity.Name}}</option>
                    </optgroup>
                  {% for group in ACTIVITY_TYPES | map(attribute = 'Group') | unique %}
                      <optgroup label="---- {{group}} ----">
                        {%for activity in ACTIVITY_TYPES | selectattr('Group', 'equalto', group) %}
                          {% if activity.Id != default.exposed_activity_type %}
                            <option value="{{activity.Id}}">{{activity.Name}}</option>
                          {% endif %}
                      {%endfor%}
                      </optgroup>
                    {%endfor%}
                   </select>
                <!-- supprimé par VKO. Anciennes activités CARA
                    <option value="office">Office</option>
                    <option value="smallmeeting">Small meeting (<10 occ.)</option>
                    <option value="largemeeting">Large meeting (>=10 occ.)</option>
                    <option value="callcentre">Call Centre</option>
                    <option value="controlroom-day">Control Room - Day shift</option>
                    <option value="controlroom-night">Control Room - Night shift</option>
                    <option value="library">Library</option>
                    <option value="lab">Laboratory</option>
                    <option value="workshop">Workshop</option>
                    <option value="training">Conference/Training</option>
                    <option value="gym">Gym</option>
                    <option value="watch_seated">Watch seated</option>
                    <option value="watch_standing">Watch standing</option>                </select> -->
            </div>
        </div>

        <div class="form-group row">
             <div class="col-sm-4"><label class="col-form-label">{{_("Mask wear ratio:")}} </label></div>
             <div class="col-sm-6 align-self-center"><input type="number" id="exposed_mask_wear_ratio" class="form-control" name="exposed_mask_wear_ratio" min=0.0 max=1.0 value={{default.exposed_mask_wear_ratio}} step=0.1 required></div>
        </div>

        <div class='sub_title'>{{_("Presence:")}}</div>
        <div class="split">
        <div>
          <label class="tabbed mb-0">{{_("Start:")}}</label>
          <input type="time" id="exposed_start" class="start_time" data-time-group="exposed" data-lunch-break="exposed_lunch" name="exposed_start" value={{default.exposed_start}} required>
        </div>
        <div>
          <label class="tabbed mb-0">{{_("Finish:")}} </label>
          <input type="time" id="exposed_finish" class="finish_time" data-time-group="exposed" data-lunch-break="exposed_lunch" name="exposed_finish" value={{default.exposed_finish}} required>
        </div>
        </div>
      </div>
      <br>

      <div class="boxMargin pb-0">
        <div class='sub_title'>{{_("Infected person(s):")}} </div>
        <div class="form-group row">
            <div class="col-sm-4"><label class="col-form-label">{{_("Activity:")}}</label></div>
            <div class="col-sm-6">
                <select id="infected_activity_type" name="infected_activity_type" class="form-control">
                      {% set default_infected_activity = ACTIVITY_TYPES | selectattr('Id', 'equalto', default.infected_activity_type) | first %}
                    <optgroup label="---- {{PLACEHOLDERS.default}} ----">
                      <option selected value="{{default_infected_activity.Id}}">{{default_infected_activity.Name}}</option>
                    </optgroup>
                  {% for group in ACTIVITY_TYPES | map(attribute = 'Group') | unique %}
                      <optgroup label="---- {{group}} ----">
                        {%for activity in ACTIVITY_TYPES | selectattr('Group', 'equalto', group) %}
                          {% if activity.Id != default.infected_activity_type %}
                            <option value="{{activity.Id}}">{{activity.Name}}</option>
                          {% endif %}
                      {%endfor%}
                      </optgroup>
                    {%endfor%}
                   </select>
                   <!-- anciennes activités CARA
                    <option value="office">Office</option>
                    <option value="smallmeeting">Small meeting (<10 occ.)</option>
                    <option value="largemeeting">Large meeting (>=10 occ.)</option>
                    <option value="callcentre">Call Centre</option>
                    <option value="controlroom-day">Control Room - Day shift</option>
                    <option value="controlroom-night">Control Room - Night shift</option>
                    <option value="library">Library</option>
                    <option value="lab">Laboratory</option>
                    <option value="workshop">Workshop</option>
                    <option value="training">Conference/Training</option>
                    <option value="gym">Gym</option>
                    <option value="watch_seated">Watch seated</option>
                    <option value="watch_standing">Watch standing</option>                </select> 
                    -->
            </div>
        </div>
        <div class="form-group row">
            <div class="col-sm-4"><label class="col-form-label">{{_("Mask wear ratio:")}} </label></div>
            <div class="col-sm-6 align-self-center"><input type="number" id="infected_mask_wear_ratio" class="form-control" name="infected_mask_wear_ratio" min=0.0 max=1.0 value={{default.infected_mask_wear_ratio}} step=0.1 required></div>
        </div>
        <div class='sub_title'>{{_("Presence:")}}</div>
        <div class="split">
        <div>
          <label class="tabbed mb-0">{{_("Start:")}} </label> 
          <input type="time" id="infected_start" class="start_time" data-time-group="infected" data-lunch-break="infected_lunch" name="infected_start" value={{default.infected_start}} required>
        </div>
        <div>
          <label class="tabbed mb-0">{{_("Finish:")}} </label>
          <input type="time" id="infected_finish" class="finish_time" data-time-group="infected" data-lunch-break="infected_lunch" name="infected_finish" value={{default.infected_finish}} required>
        </div>
        </div>
      </div>
      <br>
    </div>

    <hr width="80%">

    <div class="form-group row">
    <div class="col-sm-4"><label class="col-form-label">{{_("Which month is the event?")}}</label></div>
    <div class="col-sm-6 align-self-center">
    <select id="event_month" name="event_month" class="form-control" required>
    {% set months = MONTH_NAMES.items() | list %}
      {% for month in months %}
        {% if month[0] == default.event_month %}
          <option value = {{month[0]}} selected> {{month[1]}} </option>
        {% else %}
          <option value = {{month[0]}}> {{month[1]}} </option>
        {% endif %}
      {% endfor %}
    </select>
    </div>
    </div>
    <hr width="80%">

    <span id="activity_breaks">
      <b>{{_("Activity breaks:")}} </b>
      <div data-tooltip="{{TOOLTIPS.activity_breaks}}">
        <span class="tooltip_text">?</span>
      </div>
    </span><br>

    <!-- Lunch Options -->
    <div class="form-check">
      <input type="checkbox" id="infected_dont_have_breaks_with_exposed" class="tabbed form-check-input infected_dont_have_breaks_with_exposed_option" name="infected_dont_have_breaks_with_exposed" value='1' onclick="toggle_split_breaks()">
      <label for="infected_dont_have_breaks_with_exposed" class="form-check-label col-sm-12">{{_("Input separate breaks for infected and exposed person(s)")}} </label>

    </div><br>
    <div class="breakBoxExposed" id="DIVexposed_breaks">
      <span id="exposed_break_title"><b>{{_("Exposed person(s) breaks:")}}</b></span>
      <div class="boxMargin">
       {{_("Lunch break:")}}
        <input class="ml-2 exposed_lunch_option" type="radio" id="exposed_lunch_option_no" data-lunch-select="exposed" name="exposed_lunch_option" value=0 onclick="require_fields(this)">
          <label for="exposed_lunch_option_no">{{_("No")}} </label>
        <input class="ml-2 exposed_lunch_option" type="radio" id="exposed_lunch_option_yes" data-lunch-select="exposed" name="exposed_lunch_option" value=1 onclick="require_fields(this)">
          <label for="exposed_lunch_option_yes">{{_("Yes")}} </label><br>
        <div class="split">
        <div>
       {{_("Start:")}} <input type="time" id="exposed_lunch_start" class="start_time" data-time-group="exposed_lunch" data-lunch-for="exposed" data-has-radio="#exposed_lunch_option_yes" name="exposed_lunch_start" value={{default.exposed_lunch_start}} required>
        </div>
        <div>
       {{_("Finish:")}} <input type="time" id="exposed_lunch_finish" class="finish_time" data-time-group="exposed_lunch" data-lunch-for="exposed" data-has-radio="#exposed_lunch_option_yes" name="exposed_lunch_finish" value={{default.exposed_lunch_finish}} required><br>
        </div>
        </div>

        <!-- Coffee Options -->
        <div class="split">
        <div>
        {{_("Coffee Breaks:")}}
        </div>
        <div>
        <input type="radio" class="exposed_coffee_break_option" id="exposed_coffee_break_0" name="exposed_coffee_break_option" value="coffee_break_0">
          <label for="exposed_coffee_break_0" >{{_("No breaks")}} </label>
        <input class="ml-2 exposed_coffee_break_option" type="radio" id="exposed_coffee_break_2" name="exposed_coffee_break_option" value="coffee_break_2">
          <label for="exposed_coffee_break_2">2</label>
        <input class="ml-2 exposed_coffee_break_option" type="radio" id="exposed_coffee_break_4" name="exposed_coffee_break_option" value="coffee_break_4">
          <label for="exposed_coffee_break_4">4</label><br>
        </div>
        </div>

        <br>

       {{_("Duration (minutes):")}}
        <select id="exposed_coffee_duration" name="exposed_coffee_duration">
          {% for i in range(1,7) %}
            {% if i*5 == default.exposed_coffee_duration %}
              <option value={{default.exposed_coffee_duration}} selected>{{default.exposed_coffee_duration}}</option>
            {% else %}
              <option value={{i*5}}>{{i*5}}</option>
            {% endif %}
          {% endfor %}
        </select><br>
      </div>
      <br>
    </div>

    <div class="breakBoxInfected" id="DIVinfected_breaks">
      <b>{{_("Infected person(s) breaks:")}} </b>
      <div class="boxMargin">
       {{_("Lunch break:")}}
        <input class="ml-2 infected_lunch_option" type="radio" id="infected_lunch_option_no" data-lunch-select="infected" name="infected_lunch_option" value=0 onclick="require_fields(this)">
          <label for="infected_lunch_option_no">{{_("No")}}</label>
        <input class="ml-2 infected_lunch_option" type="radio" id="infected_lunch_option_yes" data-lunch-select="infected" name="infected_lunch_option" value=1 onclick="require_fields(this)">
          <label for="infected_lunch_option_yes">{{_("Yes")}} </label><br>

        <div class="split">
        <div>
       {{_("Start:")}} <input type="time" id="infected_lunch_start" class="start_time" data-time-group="infected_lunch" data-lunch-for="infected" data-has-radio="#infected_lunch_option_yes" name="infected_lunch_start" value={{default.infected_lunch_start}}>
        </div>
        <div>
       {{_("Finish:")}} <input type="time" id="infected_lunch_finish" class="finish_time" data-time-group="infected_lunch" data-lunch-for="infected" data-has-radio="#infected_lunch_option_yes" name="infected_lunch_finish" value={{default.infected_lunch_finish}}><br>
        </div>
        </div>

        <!-- Coffee Options -->
        <div class="split">
        <div>
       {{_("Coffee Breaks:")}}
        </div>
        <div>
        <input class="infected_coffee_break_option" type="radio" id="infected_coffee_break_0" name="infected_coffee_break_option" value="coffee_break_0">
          <label for="infected_coffee_break_0" >{{_("No breaks")}}</label>
        <input class="ml-2 infected_coffee_break_option" type="radio" id="infected_coffee_break_2" name="infected_coffee_break_option" value="coffee_break_2">
          <label for="infected_coffee_break_2">2</label>
        <input class="ml-2 infected_coffee_break_option" type="radio" id="infected_coffee_break_4" name="infected_coffee_break_option" value="coffee_break_4">
          <label for="infected_coffee_break_4">4</label><br>
        </div>
        </div>

        <br>

        {{_("Duration (minutes):")}}
        <select id="infected_coffee_duration" name="infected_coffee_duration">
          {% for i in range(1,7) %}
            {% if i*5 == default.infected_coffee_duration %}
              <option value={{default.infected_coffee_duration}} selected>{{default.infected_coffee_duration}}</option>
            {% else %}
              <option value={{i*5}}>{{i*5}}</option>
            {% endif %}
          {% endfor %}
        </select><br>
      </div>
      <br>
    </div>

    <br id="spacing">
    <i> {{_("Coffee breaks are spread evenly throughout the day.")}} </i><br>

    
    <br><br>
  </div> 
  </div>
  
</section>

<div class="center">
  <button type='submit' class="btn btn-primary bigButton" id="generate_report">
     {{_("Generate report")}}
  </button>
</div>

<br><br>

<div class="container container--padding">
  <b>{{_("Quick Guide:")}} </b><br>
  {{_("FARC stands for Flow-R Airborne Risk Calculator.
  This tool simulates the long range airborne spread SARS-CoV-2 virus in a finite volume and estimates the risk of COVID-19 infection. It is based on current scientific data and can be used to compare the effectiveness of different mitigation measures.")}} <br>
  <b>{{_("Virus data:")}}</b> <br>
  {{_("SARS-CoV-2 covers the original 'wild type' strain of the virus and three variants of concern (VOC):")}} <br>
  <ul>
    <li>{{_("Alpha (also known as B.1.1.7, first identified in UK, Sept 2020),")}} </li>
    <li>{{_("Beta (also known as B.1.351, first identified in South Africa, May 2020).")}} </li>
    <li>{{_("Gamma (also known as P.1, first identified in Brazil/Japan, Jan 2021).")}} </li>
    <li>{{_("Delta (also known as B.1.617.2, first identified in India, Oct 2020).")}} </li>
    <li>{{_("Omicron (also known as B.1.1.529, first identified in South Africa, November 2021).")}} </li>
  </ul>
  {{_("Modify the default as necessary, according to local area prevalence.")}} <br><br>
  <b>{{_("Ventilation data:")}} </b> <br>
  <ul>
    <li>{{_("Mechanical ventilation = the HVAC supply of fresh air. Check the flow rates with the concerned technical department.")}} </li>
    <li>{{_("Natural ventilation = the type of window opening. The opening distance is between the fixed frame and movable part when open (commonly used values are window height of 1.6m and window opening between 0.15m and 0.6m). In case of periodic opening, specify the duration (e.g. for 10 min) and frequency (e.g. every 60 min).")}} </li>
    <li>{{_("Bio-ventilation = the disinfected air flow of the device. The following values are based on the different fan velocities of a specific commercial device proposed by the Flow-R:")}} </li>
    <ul>
        <li> Bio-V10000 = 4000 m<sup>3</sup>{{_("/h (noisy)")}}, 7000 m<sup>3</sup>{{_("/h (very noisy)")}}, 10000 m<sup>3</sup>{{_("/h (max, very noisy. Recommended without attendance)")}}, </li>
        <li> Bio-V5000  = 2500 m<sup>3</sup>{{_("/h (noisy)")}}, 4000 m<sup>3</sup>{{_("/h (very noisy)")}},  5000 m<sup>3</sup>{{_("/h (max, very noisy. Recommended without attendance)")}}, </li>
        <li> Bio-V1000 = 800 m<sup>3</sup>{{_("/h (ultra silent)")}}, 1000 m<sup>3</sup>{{_("/h (silent)")}}, 1200 m<sup>3</sup>{{_("/h (noisy)")}}, 2700 m<sup>3</sup>{{_("/h (max, very noisy. Recommended without attendance)")}},</li>
        <li> Bio-V500 = 400 m<sup>3</sup>{{_("/h (ultra silent)")}}, 500 m<sup>3</sup>{{_("/h (silent)")}}, 600 m<sup>3</sup>{{_("/h (noisy)")}}, 1200 m<sup>3</sup>{{_("/h (max, very noisy. Recommended without attendance)")}},</li>
    </ul>
  </ul>
  <b>{{_("Activity types:")}}</b><br>
  {{_("The type of activity applies to the infected and exposed persons separately.")}} <br>
  <!-- removed 
  <ul>
    <li>Watch seated, talking 30% of the time,  loudly talking 10% of the time</li>
    <li>Watch standing still 60% of the time;  light activity 40% of the time, talking 30% of the time,  loudly talking 10% of the time</li>
    <li>Office = all seated, talking 33% of the time,</li>
    <li>Small meeting (< 10 occ.) = all seated, talking time shared between all persons,</li>
    <li>Large meeting (>= 10 occ.) = speaker is standing and speaking 33% of the time, other occupants are seated,</li>							
    <li>Call Centre = all seated, continuous talking,</li>
    <li>Control Room (day shift) = all seated, talking 50% of the time,</li>
    <li>Control Room (night shift) = all seated, talking 10% of the time,</li>
    <li>Library = all seated, no talking, just breathing,</li>
    <li>Laboratory = light physical activity, talking 50% of the time,</li>
    <li>Workshop = moderate physical activity, talking 50% of the time,</li>
    <li>Conference/Training = speaker/trainer standing and talking, rest seated and talking quietly.
    Speaker/Trainer assumed infected (worst case scenario),</li>
    <li>Gym = heavy exercise, no talking, just breathing.</li>
  </ul> -->
  <b>{{_("Activity breaks:")}} </b><br>
  {{_("If coffee breaks are included, they are spread out evenly throughout the day, in addition to any lunch break (if applicable).")}}
  </ul>
  {{_("Refer to")}}<a href="{{ calculator_prefix }}/user-guide">{{_("FARC user guide")}}</a>
  {{_("for more detailed explanations on how to use this tool.")}}<br>
</div>

<div class="center container--padding pr-3 pl-3">
<button class="btn btn-primary bigButton ml-2">
  <a id="userGuideBtn" href="{{ calculator_prefix }}/user-guide" class="{{ "nav-link active" if "user-guide" in active_page else "nav-link" }}">{{_("User guide")}} </a>
</button>
<button class="btn btn-primary bigButton  ml-2" type="button" data-toggle="collapse" data-target="#collapseDisclaimer" aria-expanded="false" aria-controls="collapseDisclaimer">
   {{_("Disclaimer")}}
</button>
</div>

<div class="collapse container container--padding" id="collapseDisclaimer">
  {{ text_blocks['Disclaimer'] }}
</div>

</form>

{% endblock main %}
